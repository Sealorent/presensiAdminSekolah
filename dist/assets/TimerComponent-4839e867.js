import{d,u as c,M as n,_ as u,o as h,c as p,a as g,t as T}from"./index-d249554b.js";import{m}from"./mainRepositories-09f24805.js";import{S as l}from"./setFormDataUtils-e6455cf7.js";const v=d("absent",{state:()=>({data:null}),actions:{async present({router:e,image:a,lokasi:t,keterangan:i}){const s=c();try{s.Loading();const o=l.setFormData({kode_sekolah:n.getLoginResponse().kode_sekolah,id_pegawai:n.getLoginResponse().id_pegawai,type:"DATANG",lokasi:t.lokasi,lati:t.latitude,longi:t.longitude,keterangan:i,image:a});(await m.present(o)).data.is_correct==!0?(s.Success(),this.setTimeArrivalNow(),e.push({name:"home"})):s.Error("something wrong")}catch(o){s.Error(o.message)}finally{s.Finish()}},async backHome({router:e,image:a,lokasi:t,keterangan:i}){const s=c();try{s.Loading();const o=l.setFormData({kode_sekolah:n.getLoginResponse().kode_sekolah,id_pegawai:n.getLoginResponse().id_pegawai,type:"PULANG",lokasi:t.lokasi,lati:t.latitude,longi:t.longitude,keterangan:i,image:a});console.log(o);const r=await m.present(o);console.log("back home"),console.log(r.data),r.data.is_correct==!0?(e.push({name:"home"}),this.setTimeBackHomeNow(),s.Success()):e.push({name:"home"})}catch(o){e.push({name:"home"}),s.Error(o.message)}finally{s.Finish()}},setTimeArrivalNow(){const e=this.setTimeNow();n.setTimeArrival(e)},setTimeBackHomeNow(){const e=this.setTimeNow();console.log("setTimeBackHomeNow"),console.log(e),n.setTimeBack(e)},setTimeNow(){const e=new Date,a=String(e.getHours()).padStart(2,"0"),t=String(e.getMinutes()).padStart(2,"0");return`${a}:${t}`}}});const _={data(){return{startTime:null,currentTime:null,countdownDuration:60}},computed:{formattedTime(){if(this.startTime){const e=Math.max(0,this.countdownDuration-this.elapsedSeconds),a=String(Math.floor(e/60)).padStart(2,"0"),t=String(e%60).padStart(2,"0");return`${a}:${t}`}else return"00:59"},elapsedSeconds(){return this.startTime?Math.floor((this.currentTime-this.startTime)/1e3):0}},created(){this.startTimer()},beforeUnmount(){this.stopTimer()},methods:{startTimer(){this.startTime=new Date,this.timerInterval=setInterval(()=>{this.currentTime=new Date,this.elapsedSeconds>=this.countdownDuration&&(this.stopTimer(),this.navigateToRoute())},1e3)},stopTimer(){clearInterval(this.timerInterval)},navigateToRoute(){}}},w={class:"text-lg"};function S(e,a,t,i,s,o){return h(),p("div",null,[g("p",w,T(o.formattedTime),1)])}const y=u(_,[["render",S]]);export{y as T,v as u};

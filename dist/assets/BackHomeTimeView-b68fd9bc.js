import{_ as f,i as x,M as _,r as c,o as m,c as d,b as r,a as s,t as p,w,v as b,e as k}from"./index-a2324071.js";import{T as v,u as C}from"./TimerComponent-af02225f.js";import{H as I}from"./HeaderMenusComponent-6f140510.js";import"./mainRepositories-09f24805.js";import"./axios-4a70c6fc.js";import"./setFormDataUtils-e6455cf7.js";const y={name:"ArrivalTimeView",components:{HeaderMenusComponent:I,Timer:v},data(){return{state:x("state"),absentSore:C(),title:"Absen Pulang",selectedLocation:_.getSelectedLocation(),currentTime:"",selectedImage:null,fileImage:null,keterangan:""}},created(){this.updateTime(),this.setCamera()},methods:{setCamera(){navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{this.$refs.video.srcObject=t}).catch(t=>{console.error("Error accessing webcam:",t)})},async captureFrameFromVideo(){const t=this.$refs.video;if(!t)return;const e=document.createElement("canvas");e.width=t.videoWidth,e.height=t.videoHeight,e.getContext("2d").drawImage(t,0,0,e.width,e.height);const o=await new Promise(n=>{e.toBlob(i=>{n(i)},"image/jpeg")});this.fileImage=new File([o],"captured_image.jpg",{type:"image/jpeg"}),this.selectedImage=URL.createObjectURL(o)},updateTime(){const t=new Date,e=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");this.currentTime=`${e}:${l}:${o}`},handleFileInputClick(){this.$refs.fileInput.click()},handleFileInputChange(t){const e=t.target.files[0];this.fileImage=e,e&&(this.selectedImage=URL.createObjectURL(e))},async submit(){this.fileImage==null?this.$alertStore.showAlert("danger","Lengkapi Data Absen !"):(this.keterangan==""&&(this.keterangan="PULANG"),this.state.Loading(),await this.absentSore.backHome({router:this.$router,image:this.fileImage,keterangan:this.keterangan,lokasi:this.selectedLocation}))}}},S={class:"flex flex-col w-full h-screen"},T={class:"flex flex-col flex-grow pt-2"},F=s("p",{class:"text-center"},"Batas Waktu Absen 60 Detik",-1),L=s("p",{class:"text-center"},"Setelah itu Halaman akan Tertutup otomatis",-1),j={class:"flex flex-row items-center pt-2 mx-4 gap-x-2"},A={class:"flex flex-row items-center pt-2 mx-4 gap-x-2"},H={class:"pt-2 text-center"},V=["src"],M={key:1,ref:"video",class:"w-full h-full",autoplay:""},B={class:"flex flex-col items-center justify-center pt-2 gap-y-2"};function U(t,e,l,o,n,i){const g=c("HeaderMenusComponent"),u=c("font-awesome-icon"),h=c("Timer");return m(),d("div",S,[r(g,{title:n.title},null,8,["title"]),s("div",T,[F,L,s("div",j,[r(u,{icon:["far","clock"],class:"text-[20px]"}),s("p",null,p(n.currentTime),1)]),s("div",A,[r(u,{icon:["fas","street-view"],class:"text-[20px]"}),s("p",null,p(n.selectedLocation.lokasi),1)]),s("div",H,[s("div",{onClick:e[0]||(e[0]=(...a)=>i.handleFileInputClick&&i.handleFileInputClick(...a)),class:"container flex flex-col items-center justify-center w-40 h-40 bg-primaryColors rounded-xl"},[n.selectedImage!==null?(m(),d("img",{key:0,src:n.selectedImage,alt:"",style:{height:"100%",width:"100%"}},null,8,V)):(m(),d("video",M,null,512))]),s("button",{onClick:e[1]||(e[1]=(...a)=>i.captureFrameFromVideo&&i.captureFrameFromVideo(...a)),class:"mt-2 text-white btn bg-primaryColors"}," Ambil Foto ")]),s("div",B,[w(s("input",{type:"text",placeholder:"Catatan","onUpdate:modelValue":e[2]||(e[2]=a=>n.keterangan=a),class:"w-full max-w-xs input input-bordered"},null,512),[[b,n.keterangan]]),s("button",{onClick:e[3]||(e[3]=(...a)=>i.submit&&i.submit(...a)),class:"text-white btn bg-primaryColors"},[k("Kirim Absen "),s("span",null,[r(h)])])])])])}const W=f(y,[["render",U]]);export{W as default};
